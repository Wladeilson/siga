#{extends 'main.html' /} #{set title:'Edição de Conhecimento' /}

<div class="gt-bd gt-cols clearfix">
        <div class="gt-content">
                <h2>Cadastro de Conhecimento</h2>

                <div class="gt-form gt-content-box">
                        <form>
                        	<div class="gt-form-row">
								<label>Item de Configuração</label> 
								#{selecaoAutoComplete nome:'itemConfiguracao', onchange:'mostraOuEscondeAcao();carregarRelacionados();', items:models.SrItemConfiguracao.listar(false)/}
							</div>
							<div style="display: inline-block" >
								<div id="gc-ancora-item"></div>
							</div>
							<div class="gt-form-row" id="divAcao">
								<label>Ação</label> #{selecaoAutocomplete nome:'acao', onchange:'carregarRelacionados();', items:models.SrAcao.listar(false) /}
							</div>
							<div style="display: inline-block" >
								<div id="gc-ancora-item-acao"></div>
							</div>
                        </form>
                </div>
        </div>
        <div id="divRelacionados"></div>
</div>



<script>
function mostraOuEscondeAcao(){
	if ($('#search_itemConfiguracao')[0].value != '')
		$("#divAcao").show();
	else {
		$("#divAcao").hide();
		$("#acao").val('');
		$("#search_acao").val('');
		$("#descr_acao").html('');
		$("#gc-ancora-item").html('');
		$("#gc-ancora-item-acao").html('');
	}
};


function carregarRelacionados() {
	PassAjaxResponseToFunction('@{Application.listarConhecimento()}?ajax=true&idItem=' 
			+ $("#itemConfiguracao").val() + '&idAcao=' + $("#acao").val(), 'carregouRelacionados', null, false, null);
}

function carregouRelacionados(response, param){
	var div = document.getElementById('divRelacionados');
	div.innerHTML = response;

	var scripts = div.getElementsByTagName("script");
	for(var i=0;i<scripts.length;i++)  
		   eval(scripts[i].text); 
}

mostraOuEscondeAcao();
</script>

